# Gangle (Guess the angle)

Gangle is a game where the player has to guess the angle of two line segments forming an angle.
The game is happening over the telegram platform using a bot. It is played only in group chats.
The bot will post a message with an image of an angle to guess and each person in the group is considered as a player. Each player has to reply to that message with their guess of the angle in degrees.
The player who guesses the angle closest to the actual angle wins the round and gets 100 points. The points assigned are then scaled based on how close the guess was to the actual angle. The closer the guess, the more points the player gets.
Only one round is played at time. After a round is finished, the bot will post the results of the round and start a new round after a short delay.

A leaderboard is maintained to keep track of the players' scores. The leaderboard is updated after each round and can be viewed by any player at any time by sending a command to the bot.

Admin of the group has the ability to declare forfait for a player, which will remove the player from the current round and they will not be able to participate in that round anymore. The admin can also reset the leaderboard if needed.

The game is designed to be simple and fun, encouraging players to think about angles and geometry in a playful way.

The guess is happening with the use of inline buttons and callback queries to keep the chat clean and avoid cluttering the chat with multiple messages. This also allows to avoid bias in the voting as 
players can't see each other's guesses until the round is over.

## üîß Flow Overview

1. Bot sends round message in group

2. Posts angle image

3. Inline button: [ Guess ]

4. Player presses "Guess" button

5. Bot responds via callback with an ephemeral/private message visible only to that player:
‚ÄúPlease send me your guess (0‚Äì359). Just type the number here.‚Äù

6. Player submits a number

7. Bot parses the input (callback context ‚Üí knows it belongs to current round).

8. Stores the guess in memory/db.

9. Posts status update in group:
‚Äú‚úÖ Alice has submitted‚Äù

10. When all active players submitted (or admin forces forfeits)

11. Bot computes distances, assigns points.

12. Posts reveal message with correct angle + all guesses + updated leaderboard.


## Commands

- Anyone in the group can type `/leaderboard` to see the current leaderboard.
- Admins can type `/forfeit @username` to remove a player from the current round.
- Admins can type `/reset_leaderboard` to reset the leaderboard.
- Any player can type `/start_round` to manually start a new round if no other rounds are active.
- Any player can type `/help` to see the list of commands and how to play the game.


## Implementation Details
- The bot is implemented using the Telegram Bot API.
- The angle images are generated by the `render_angle()` function in the `rendering.py` file.
- The game state (current round, players, guesses, leaderboard) is managed using a simple file-based database or in-memory storage for simplicity.
- The bot uses inline buttons and callback queries to handle player interactions.
- The bot is designed to handle multiple groups independently, maintaining separate game states for each group.
- Error handling is implemented to manage invalid inputs and edge cases (e.g., no players, all players forfeited, etc.).
- The bot is hosted on a server that can run Python scripts and has access to the internet to communicate with the Telegram API.
- Rounds can only be started via user command /start_round
- The group only sees ‚Äúwho has submitted,‚Äù not ‚Äúwhat they submitted.‚Äù
- The bot should handle cases where players leave the group or are removed during an active round.
- The bot should handle cases where the bot is removed from the group or the group is deleted.
- The bot should handle cases where the bot is restarted or crashes during an active round, ensuring that the game state is preserved and can be resumed.
- The bot should handle cases where multiple players submit their guesses at the same time, ensuring that all guesses are recorded correctly.
- The reveal of the correct angle and guesses should be formatted in a clear and visually appealing way, possibly using Markdown or HTML formatting supported by Telegram.
- The bot should log important events and errors for debugging and monitoring purposes.

## Project details
- Use git for version control.
- Use a virtual environment for Python dependencies, either `uv` or `venv`.
- Use `pip` for managing Python packages.
- Add a `README.md` file with instructions on how to set up and run the bot.
- Use a `.env` file to store sensitive information like the Telegram bot token.
- Ensure the code is well-documented with comments and docstrings.
- Use and MIT LICENSE for the project.